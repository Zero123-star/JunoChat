import{b as I,u as E,r as i,t as m,j as e,B as j}from"./index-C6xq9Q1d.js";import{m as v,S as D,a as P,u as L}from"./api-iqijItGs.js";import{I as N}from"./input-B0BXk12S.js";import{L as n}from"./label-Bc_BKVne.js";import{I as R}from"./image-vyDWG_4G.js";const A=()=>{const{id:c}=I(),o=E(),[y,w]=i.useState(null),[s,d]=i.useState({}),[u,p]=i.useState(null),[x,g]=i.useState(!1),[f,b]=i.useState(null);i.useEffect(()=>{if(!localStorage.getItem("token")){m.error("Please log in to edit a character"),o("/login");return}(async()=>{if(c)try{const a=await P(c);w(a),d({...a,tags:a.tags||""}),a.avatar&&b(a.avatar)}catch{p("Failed to load character"),m.error("Failed to load character")}})()},[c,o]);const k=async r=>{if(r.preventDefault(),!!c){g(!0),p(null);try{await L(c,s),m.success("Character updated successfully!"),o("/characters")}catch{p("Failed to update character. Please try again."),m.error("Failed to update character")}finally{g(!1)}}},h=r=>{const{name:t,value:a}=r.target;d(l=>({...l,[t]:a}))},C=r=>{const t=r.target.value.split(",").map(a=>a.trim());d(a=>({...a,tags:t.join(",")}))},S=r=>{var a;const t=(a=r.target.files)==null?void 0:a[0];if(t){const l=new FileReader;l.onloadend=()=>{b(l.result),d(F=>({...F,avatar:l.result}))},l.readAsDataURL(t)}};return y?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-white via-purple-50 to-pink-50 dark:from-black dark:via-zinc-900 dark:to-gray-900 px-4 py-6 flex items-center justify-center",children:e.jsx(v.div,{className:"w-full max-w-md",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs("div",{className:"bg-white/70 backdrop-blur-md p-8 rounded-2xl shadow-xl border border-pink-100",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(v.div,{className:"inline-block",initial:{scale:.8},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:e.jsx(D,{className:"text-pink-500 h-8 w-8 mx-auto mb-2"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-transparent bg-clip-text",children:"Edit Character"}),e.jsx("p",{className:"text-purple-700 mt-2",children:"Update your character's details"})]}),u&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",className:"text-purple-800 font-medium",children:"Name"}),e.jsx(N,{id:"name",type:"text",name:"name",value:s.name||"",onChange:h,placeholder:"Enter character name",required:!0,className:"bg-white/50 border-pink-200 focus:border-purple-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",className:"text-purple-800 font-medium",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:s.description||"",onChange:h,placeholder:"Describe your character",required:!0,rows:4,className:"w-full px-3 py-2 bg-white/50 border border-pink-200 rounded-lg focus:border-purple-400 focus:outline-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"image",className:"text-purple-800 font-medium",children:"Character Image"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-center w-full h-32 border-2 border-dashed border-pink-200 rounded-lg cursor-pointer hover:border-purple-400 transition-colors",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"h-8 w-8 mx-auto text-pink-500"}),e.jsx("p",{className:"mt-2 text-sm text-purple-700",children:"Click to upload image"})]}),e.jsx("input",{type:"file",id:"image",accept:"image/*",onChange:S,className:"hidden"})]})}),f&&e.jsx("img",{src:f,alt:"Preview",className:"h-32 w-32 object-cover rounded-lg"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tags",className:"text-purple-800 font-medium",children:"Tags"}),e.jsx(N,{id:"tags",type:"text",value:s.tags||"",onChange:C,placeholder:"Enter tags (comma-separated)",className:"bg-white/50 border-pink-200 focus:border-purple-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"color",className:"text-purple-800 font-medium",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"color",id:"color",name:"color",value:s.color||"#000000",onChange:h,className:"h-10 w-20 rounded-lg cursor-pointer"}),e.jsx("span",{className:"text-purple-700",children:s.color||"#000000"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(j,{type:"button",onClick:()=>o("/characters"),className:"bg-white/10 backdrop-blur-md text-white border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300",children:"Cancel"}),e.jsx(j,{type:"submit",disabled:x,className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 border-0 shadow-lg hover:shadow-xl transition-all duration-200",children:x?"Saving...":"Save Changes"})]})]})]})})}):e.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-gradient-to-br from-purple-50 via-pink-50 to-yellow-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-purple-700",children:"Loading character..."})]})})};export{A as default};
